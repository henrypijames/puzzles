<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg id="Riverbank_Example" version="1.1"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns:xlink="http://www.w3.org/1999/xlink"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   width="4.75in" height="6.75in" viewBox="-.25 -1.25 9.5 13.5">
  <sodipodi:namedview id="namedview-0"
     units="pc" inkscape:document-units="pc" inkscape:pagecheckerboard="1">
  </sodipodi:namedview>
  <style type="text/css">@import url('http://fonts.googleapis.com/css?family=Merriweather|Merriweather Sans');</style>
  <style>
    .pos {fill: #fff; stroke: #none}
    .neg {fill: #000; stroke: #none}
    .mark {fill: none; stroke: #000; stroke-width: .4}
    .shape {fill: none; stroke: black; stroke-width: .02; stroke-dasharray: .08}
    .digit {text-anchor: middle; dominant-baseline: central; font-size: .6pt; font-family: 'Merriweather Sans'}
    #river {fill: deepskyblue}
    #title {font-size: .4pt; font-family: 'Merriweather'}
    #notes {font-size: .2pt; font-family: 'Merriweather'}
    .bold {font-weight: bold}
    svg {background-color: white}
    .fill {fill: black; stroke: none}
    .stroke {fill: none; stroke: black}
    @media_ (prefers-color-scheme: dark) {
      svg {background-color: black}
      .fill {fill: white; stroke: none}
      .stroke {fill: none; stroke: white}
      text {fill: white}
    }
  </style>
  <defs id="objects">
    <rect id="s" width="1" height="1" />
    <line id="r" x2="9" />
    <line id="c" y2="9" />
    <rect id="bq" x="-2" y="-2" width="4" height="4" transform="scale(.12)" />
    <circle id="uk" r="1.2" transform="scale(.12)" />
    <rect id="uq" x="-1.1" y="-1.1" width="2.2" height="2.2" transform="scale(.12)" />
    <mask id="vm">
      <use id="vb" class="pos" xlink:href="#bq" />
      <path id="vs" class="mark" transform="scale(.12)"
         d="M -.8,-.1 -.2,.5 .8,-.5" />
    </mask>
    <mask id="xm">
      <use id="xb" class="pos" xlink:href="#bq" />
      <path id="xs" class="mark" transform="scale(.12)"
         d="M -.6,-.6 .6,.6 M .6,-.6 -.6,.6" />
    </mask>
    <use id="vk" xlink:href="#uk" mask="url(#vm)" />
    <use id="vq" xlink:href="#uq" mask="url(#vm)" />
    <use id="xk" xlink:href="#uk" mask="url(#xm)" />
    <use id="xq" xlink:href="#uq" mask="url(#xm)" />
  </defs>
  <mask id="gm">
    <rect id="canvas" class="pos" x="-3" y="-3" width="15" height="15" />
    <g id="bmm" class="neg">
      <!-- generated by script (see further below) -->
    </g>
  </mask>
  <g id="shading" inkscape:groupmode="layer" mask="url(#gm)">
    <g id="river">
      <use id="s-26" xlink:href="#s" transform="translate(5,1)" />
      <use id="s-36" xlink:href="#s" transform="translate(5,2)" />
      <use id="s-37" xlink:href="#s" transform="translate(6,2)" />
      <use id="s-38" xlink:href="#s" transform="translate(7,2)" />
      <use id="s-48" xlink:href="#s" transform="translate(7,3)" />
      <use id="s-58" xlink:href="#s" transform="translate(7,4)" />
      <use id="s-57" xlink:href="#s" transform="translate(6,4)" />
      <use id="s-67" xlink:href="#s" transform="translate(6,5)" />
      <use id="s-66" xlink:href="#s" transform="translate(5,5)" />
      <use id="s-65" xlink:href="#s" transform="translate(4,5)" />
      <use id="s-75" xlink:href="#s" transform="translate(4,6)" />
      <use id="s-85" xlink:href="#s" transform="translate(4,7)" />
      <use id="s-84" xlink:href="#s" transform="translate(3,7)" />
      <use id="s-83" xlink:href="#s" transform="translate(2,7)" />
      <use id="s-73" xlink:href="#s" transform="translate(2,6)" />
      <use id="s-63" xlink:href="#s" transform="translate(2,5)" />
      <use id="s-53" xlink:href="#s" transform="translate(2,4)" />
      <use id="s-52" xlink:href="#s" transform="translate(1,4)" />
      <use id="s-51" xlink:href="#s" transform="translate(0,4)" />
      <use id="s-61" xlink:href="#s" transform="translate(0,5)" />
      <use id="s-71" xlink:href="#s" transform="translate(0,6)" />
      <use id="s-81" xlink:href="#s" transform="translate(0,7)" />
    </g>
    <circle id="k-47" class="shape" cx="6.5" cy="3.5" r=".45" />
    <rect id="w-47" class="shape" x="5.25" y="2.25" width="2.5" height="2.5" />
    <rect id="q-73" class="shape" x="2.1" y="6.1" width=".8" height=".8" />
    <line id="r-73" class="shape" x2="9" y1="6.5" y2="6.5" />
    <line id="c-73" class="shape" x1="2.5" x2="2.5" y2="9" />
  </g>
  <g id="grid" inkscape:groupmode="layer" mask="url(#gm)">
    <text id="title" x="0" y="-.5">Riverbank ruleset example</text>
    <g id="thick" class="stroke" style="stroke-width:.03">
      <rect id="edge" width="9" height="9" />
      <use id="r-3" xlink:href="#r" transform="translate(0,3)" />
      <use id="r-6" xlink:href="#r" transform="translate(0,6)" />
      <use id="c-3" xlink:href="#c" transform="translate(6,0)" />
      <use id="c-6" xlink:href="#c" transform="translate(3,0)" />
    </g>
    <g id="thin" class="stroke" style="stroke-width:.01">
      <use id="r-1" xlink:href="#r" transform="translate(0,1)" />
      <use id="r-2" xlink:href="#r" transform="translate(0,2)" />
      <use id="r-4" xlink:href="#r" transform="translate(0,4)" />
      <use id="r-5" xlink:href="#r" transform="translate(0,5)" />
      <use id="r-7" xlink:href="#r" transform="translate(0,7)" />
      <use id="r-8" xlink:href="#r" transform="translate(0,8)" />
      <use id="c-1" xlink:href="#c" transform="translate(1,0)" />
      <use id="c-2" xlink:href="#c" transform="translate(2,0)" />
      <use id="c-4" xlink:href="#c" transform="translate(4,0)" />
      <use id="c-5" xlink:href="#c" transform="translate(5,0)" />
      <use id="c-7" xlink:href="#c" transform="translate(7,0)" />
      <use id="c-8" xlink:href="#c" transform="translate(8,0)" />
    </g>
  </g>
  <g id="clues" inkscape:groupmode="layer">
    <text id="d-47" x="6.5" y="3.5" class="digit">5</text>
    <text id="d-73" x="2.5" y="6.5" class="digit">7</text>
    <g id="bm" class="fill">
      <use id="vk-c53" xlink:href="#vk" transform="translate(5.5,3)" />
      <use id="vk-c73" xlink:href="#vk" transform="translate(6.5,3)" />
      <use id="vk-r47" xlink:href="#vk" transform="translate(7,3.5)" />
      <use id="vk-c74" xlink:href="#vk" transform="translate(6.5,4)" />
      <use id="vk-r56" xlink:href="#vk" transform="translate(6,4.5)" />
      <use id="xk-r35" xlink:href="#xk" transform="translate(5,2.5)" />
      <use id="xk-c72" xlink:href="#xk" transform="translate(6.5,2)" />
      <use id="xk-c82" xlink:href="#xk" transform="translate(7.5,2)" />
      <use id="xk-r38" xlink:href="#xk" transform="translate(8,2.5)" />
      <use id="xk-r48" xlink:href="#xk" transform="translate(8,3.5)" />
      <use id="xk-r58" xlink:href="#xk" transform="translate(8,4.5)" />
      <use id="xk-c85" xlink:href="#xk" transform="translate(7.5,5)" />
      <use id="vq-r71" xlink:href="#vq" transform="translate(1,6.5)" />
      <use id="vq-r72" xlink:href="#vq" transform="translate(2,6.5)" />
      <use id="vq-r73" xlink:href="#vq" transform="translate(3,6.5)" />
      <use id="vq-r74" xlink:href="#vq" transform="translate(4,6.5)" />
      <use id="vq-r75" xlink:href="#vq" transform="translate(5,6.5)" />
      <use id="vq-c34" xlink:href="#vq" transform="translate(2.5,4)" />
      <use id="vq-c38" xlink:href="#vq" transform="translate(2.5,8)" />
      <use id="xq-r70" xlink:href="#xq" transform="translate(0,6.5)" />
    </g>
    <text id="notes" x="0" y="9.5">
      <tspan x="0">• </tspan>
      <tspan x=".2">The circled 5 is a <tspan class="bold">sweeper</tspan>, which counts 5 riverbank segments </tspan>
      <tspan x=".2" dy=".4">marked with small circled checks, while ignoring segments </tspan>
      <tspan x=".2" dy=".4">marked with circled crosses because those are not “between” </tspan>
      <tspan x=".2" dy=".4">its surrounding 3×3 cells.</tspan>
      <tspan x="0" dy=".4">• </tspan>
      <tspan x=".2">The squared 7 is a <tspan class="bold">sentinel</tspan>, which counts 7 riverbank segments </tspan>
      <tspan x=".2" dy=".4">marked with small squared checks, while ignoring segments </tspan>
      <tspan x=".2" dy=".4">marked with squared crosses because those are on grid edge.</tspan>
    </text>
  </g>
  <script>
    // <![CDATA[
    let xl = 'http://www.w3.org/1999/xlink';
    let bm = document.getElementById('bm');
    let bmm = document.getElementById('bmm');
    for (let s of bm.children) {
      let sm = s.cloneNode();
      sm.id = sm.id.replace(/^(\w+)(\-\w+)$/, '$1m$2');
      let hr = sm.getAttributeNS(xl, 'href');
      hr = hr.replace(/^(\#)([xv])([kq])$/, '$1u$3');
      sm.setAttributeNS(xl, 'href', hr);
      bmm.appendChild(sm);
    }
    // ]]>
  </script>
</svg>
