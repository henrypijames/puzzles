<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg id="Riverbank_Example" version="1.1"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns:xlink="http://www.w3.org/1999/xlink"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   width="4.75in" height="6.75in" viewBox="-25 -125 950 1350">
  <sodipodi:namedview id="namedview-0"
     units="pc" inkscape:document-units="pc" inkscape:pagecheckerboard="1">
  </sodipodi:namedview>
  <style type="text/css">
    @import url('https://fonts.googleapis.com/css2?family=Merriweather+Sans&amp;family=Merriweather:ital,wght@0,400;0,700;1,400&amp;display=swap');
    .pos {fill: #fff; stroke: #none}
    .neg {fill: #000; stroke: #none}
    .mark {fill: none; stroke: #000; stroke-width: 4}
    .fill {fill: black; stroke: none}
    .stroke {fill: none; stroke: black}
    #river {fill: powderblue}
    #vk, #vq {fill: green}
    #xk, #xq {fill: red}
    .shape {fill: none; stroke: black; stroke-width: 2}
    .vis {stroke-dasharray: 8}
    .digit {text-anchor: middle; dominant-baseline: central; font-size: 60pt; font-family: 'Merriweather Sans'}
    #title {font-size: 36pt; font-family: Merriweather}
    #notes {font-size: 18pt; font-family: Merriweather}
    .bold {font-weight: bold}
    @media (prefers-color-scheme: dark) {
      svg {background-color: black}
      #river {fill: steelblue}
      .shape {stroke: white}
      .fill {fill: white}
      .stroke {stroke: white}
      text {fill: white}
    }
  </style>
  <defs id="objects">
    <rect id="s" width="100" height="100" />
    <line id="r" x2="900" />
    <line id="c" y2="900" />
    <rect id="bq" x="-20" y="-20" width="40" height="40" transform="scale(1.2)" />
    <circle id="uk" r="12" transform="scale(1.2)" />
    <rect id="uq" x="-11" y="-11" width="22" height="22" transform="scale(1.2)" />
    <mask id="vm">
      <use id="vb" class="pos" xlink:href="#bq" />
      <path id="vs" class="mark" transform="scale(1.2)"
         d="M -8,-1 -2,5 8,-5" />
    </mask>
    <mask id="xm">
      <use id="xb" class="pos" xlink:href="#bq" />
      <path id="xs" class="mark" transform="scale(1.2)"
         d="M -6,-6 6,6 M 6,-6 -6,6" />
    </mask>
    <use id="vk" xlink:href="#uk" mask="url(#vm)" />
    <use id="vq" xlink:href="#uq" mask="url(#vm)" />
    <use id="xk" xlink:href="#uk" mask="url(#xm)" />
    <use id="xq" xlink:href="#uq" mask="url(#xm)" />
  </defs>
  <mask id="gm">
    <rect id="canvas" class="pos" x="-300" y="-300" width="1500" height="1500" />
    <g id="bmm" class="neg">
      <!-- generated by script (see further below) -->
    </g>
  </mask>
  <g id="shading" inkscape:groupmode="layer" mask="url(#gm)">
    <g id="river">
      <use id="s-58" xlink:href="#s" transform="translate(700,400)" />
      <use id="s-59" xlink:href="#s" transform="translate(800,400)" />
      <use id="s-69" xlink:href="#s" transform="translate(800,500)" />
      <use id="s-79" xlink:href="#s" transform="translate(800,600)" />
      <use id="s-89" xlink:href="#s" transform="translate(800,700)" />
      <use id="s-88" xlink:href="#s" transform="translate(700,700)" />
      <use id="s-87" xlink:href="#s" transform="translate(600,700)" />
      <use id="s-77" xlink:href="#s" transform="translate(600,600)" />
      <use id="s-76" xlink:href="#s" transform="translate(500,600)" />
      <use id="s-66" xlink:href="#s" transform="translate(500,500)" />
      <use id="s-56" xlink:href="#s" transform="translate(500,400)" />
      <use id="s-46" xlink:href="#s" transform="translate(500,300)" />
      <use id="s-47" xlink:href="#s" transform="translate(600,300)" />
      <use id="s-37" xlink:href="#s" transform="translate(600,200)" />
      <use id="s-27" xlink:href="#s" transform="translate(600,100)" />
      <use id="s-26" xlink:href="#s" transform="translate(500,100)" />
      <use id="s-25" xlink:href="#s" transform="translate(400,100)" />
      <use id="s-15" xlink:href="#s" transform="translate(400,0)" />
      <use id="s-14" xlink:href="#s" transform="translate(300,0)" />
      <use id="s-13" xlink:href="#s" transform="translate(200,0)" />
      <use id="s-12" xlink:href="#s" transform="translate(100,0)" />
      <use id="s-11" xlink:href="#s" transform="translate(0,0)" />
      <use id="s-21" xlink:href="#s" transform="translate(0,100)" />
      <use id="s-31" xlink:href="#s" transform="translate(0,200)" />
      <use id="s-32" xlink:href="#s" transform="translate(100,200)" />
      <use id="s-33" xlink:href="#s" transform="translate(200,200)" />
      <use id="s-43" xlink:href="#s" transform="translate(200,300)" />
      <use id="s-53" xlink:href="#s" transform="translate(200,400)" />
      <use id="s-52" xlink:href="#s" transform="translate(100,400)" />
      <use id="s-51" xlink:href="#s" transform="translate(0,400)" />
      <use id="s-61" xlink:href="#s" transform="translate(0,500)" />
      <use id="s-71" xlink:href="#s" transform="translate(0,600)" />
      <use id="s-72" xlink:href="#s" transform="translate(100,600)" />
      <use id="s-82" xlink:href="#s" transform="translate(100,700)" />
    </g>
    <circle id="k-47" class="shape" cx="650" cy="350" r="45" />
    <rect id="kv-47" class="shape vis" x="525" y="225" width="250" height="250" />
    <rect id="q-73" class="shape" x="210" y="610" width="80" height="80" />
    <rect id="qv" class="shape vis" x="25" y="25" width="850" height="850" />
    <line id="rv-7" class="shape vis" x1="25" x2="875" y1="650" y2="650" />
    <line id="cv-3" class="shape vis" x1="250" x2="250" y1="25" y2="875" />
  </g>
  <g id="grid" inkscape:groupmode="layer" mask="url(#gm)">
    <text id="title" x="0" y="-50">Riverbank ruleset example</text>
    <g id="thick" class="stroke" style="stroke-width:3">
      <rect id="edge" width="900" height="900" />
      <use id="r-3" xlink:href="#r" transform="translate(0,300)" />
      <use id="r-6" xlink:href="#r" transform="translate(0,600)" />
      <use id="c-3" xlink:href="#c" transform="translate(600,0)" />
      <use id="c-6" xlink:href="#c" transform="translate(300,0)" />
    </g>
    <g id="thin" class="stroke" style="stroke-width:1">
      <use id="r-1" xlink:href="#r" transform="translate(0,100)" />
      <use id="r-2" xlink:href="#r" transform="translate(0,200)" />
      <use id="r-4" xlink:href="#r" transform="translate(0,400)" />
      <use id="r-5" xlink:href="#r" transform="translate(0,500)" />
      <use id="r-7" xlink:href="#r" transform="translate(0,700)" />
      <use id="r-8" xlink:href="#r" transform="translate(0,800)" />
      <use id="c-1" xlink:href="#c" transform="translate(100,0)" />
      <use id="c-2" xlink:href="#c" transform="translate(200,0)" />
      <use id="c-4" xlink:href="#c" transform="translate(400,0)" />
      <use id="c-5" xlink:href="#c" transform="translate(500,0)" />
      <use id="c-7" xlink:href="#c" transform="translate(700,0)" />
      <use id="c-8" xlink:href="#c" transform="translate(800,0)" />
    </g>
  </g>
  <g id="clues" inkscape:groupmode="layer">
    <text id="d-47" x="650" y="350" class="digit">8</text>
    <text id="d-73" x="250" y="650" class="digit">7</text>
    <g id="bm" class="fill">
      <use id="vk-c63" xlink:href="#vk" transform="translate(550,300)" />
      <use id="vk-r36" xlink:href="#vk" transform="translate(600,250)" />
      <use id="vk-r37" xlink:href="#vk" transform="translate(700,250)" />
      <use id="vk-r47" xlink:href="#vk" transform="translate(700,350)" />
      <use id="vk-c74" xlink:href="#vk" transform="translate(650,400)" />
      <use id="vk-r56" xlink:href="#vk" transform="translate(600,450)" />
      <use id="vk-r57" xlink:href="#vk" transform="translate(700,450)" />
      <use id="vk-c84" xlink:href="#vk" transform="translate(750,400)" />
      <use id="xk-c62" xlink:href="#xk" transform="translate(550,200)" />
      <use id="xk-r45" xlink:href="#xk" transform="translate(500,350)" />
      <use id="xk-r55" xlink:href="#xk" transform="translate(500,450)" />
      <use id="xk-c85" xlink:href="#xk" transform="translate(750,500)" />
      <use id="vq-r72" xlink:href="#vq" transform="translate(200,650)" />
      <use id="vq-r75" xlink:href="#vq" transform="translate(500,650)" />
      <use id="vq-r77" xlink:href="#vq" transform="translate(700,650)" />
      <use id="vq-r78" xlink:href="#vq" transform="translate(800,650)" />
      <use id="vq-c31" xlink:href="#vq" transform="translate(250,100)" />
      <use id="vq-c32" xlink:href="#vq" transform="translate(250,200)" />
      <use id="vq-c35" xlink:href="#vq" transform="translate(250,500)" />
      <use id="xq-r70" xlink:href="#xq" transform="translate(0,650)" />
      <use id="xq-r79" xlink:href="#xq" transform="translate(900,650)" />
      <use id="xq-c30" xlink:href="#xq" transform="translate(250,0)" />
    </g>
    <text id="notes" x="0" y="950">
      <tspan x=".25em">• </tspan>
      <tspan x="1em">The circled 8 is a <tspan class="bold">sweeper</tspan>, which counts 8 riverbank segments </tspan>
      <tspan x="1em" dy="1.5em">marked with small circled checks, while ignoring segments </tspan>
      <tspan x="1em" dy="1.5em">marked with circled crosses because those are not “within” </tspan>
      <tspan x="1em" dy="1.5em">its surrounding 3×3 cells.</tspan>
      <tspan x=".25em" dy="1.5em">• </tspan>
      <tspan x="1em">The squared 7 is a <tspan class="bold">sentinel</tspan>, which counts 7 riverbank segments </tspan>
      <tspan x="1em" dy="1.5em">marked with small squared checks, while ignoring segments </tspan>
      <tspan x="1em" dy="1.5em">marked with squared crosses because those are on grid edge.</tspan>
      <tspan x=".25em" dy="1.5em">• </tspan>
      <tspan x="1em">Each sweeper and sentinel may be either on or off river.</tspan>
    </text>
  </g>
  <script>
    // <![CDATA[
    let xl = 'http://www.w3.org/1999/xlink';
    let bm = document.getElementById('bm');
    let bmm = document.getElementById('bmm');
    for (let s of bm.children) {
      let sm = s.cloneNode();
      sm.id = sm.id.replace(/^(\w+)(\-\w+)$/, '$1m$2');
      let hr = sm.getAttributeNS(xl, 'href');
      hr = hr.replace(/^(\#)([xv])([kq])$/, '$1u$3');
      sm.setAttributeNS(xl, 'href', hr);
      bmm.appendChild(sm);
    }
    // ]]>
  </script>
</svg>
